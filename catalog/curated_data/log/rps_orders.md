# RPS Orders

This table contains all orders from the RPS order transmission service. Please Familiarize yourself with RPS order transmission using our [Documentation](https://oma.stg.restaurant-partners.com/manual/index.html#_rps-in-a-nutshell).
For our cancellation definitions we use Global Fail Reasons (GFR). You can find an overview in our [GFR Standardization project](https://confluence.deliveryhero.com/display/RPS/Global+Fail+Reasons+%28GFR%29+Standardization).
 
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| region | `STRING` | The region assigned to the country of the vendor. | ap, eu, kr, mena and us |
| service | `STRING` | The application providing the order transmission service. | iCash or OMA |
| transmission_flow | `STRING` | If the order is a Restaurant order or Grocery order. | Restaurant, Grocery or Logistics Service. |
| country_iso | `STRING` | A two-character alphanumeric code based on the country of the vendor as specified by ISO 3166-1 ALPHA-2. | AE, AR, AT, AU, BA, etc |
| [entity](#entity) | `RECORD` | Entity related data. | |
| created_date | `STRING` | The partition column. The date when this row of record is generated within the RPS systems. | |
| created_at | `TIMESTAMP` | The timestamp when this row of record is generated within the RPS systems. | |
| order_id | `STRING` | The identifier of the order generated within the RPS service. | |
| order_code | `STRING` | The identifier of the order that is sent from the platform (e.g. Foodpanda) to the RPS systems. It is specific to the order within a country. | |
| pos_order_id | `STRING` | The identifier of the order used within POS Middleware in RPS. | |
| [vendor](#vendor) | `RECORD` | All vendor related information of the order. | |
| timezone | `STRING` | The name of the timezone where the city of the vendor is located. The timezone enables time conversion, from UTC to local time. | |
| delivery_type | `STRING` | The delivery type chosen for the order. OWN_DELIVERY means the order will be fulfilled by Delivery Hero's own fleet; VENDOR_DELIVERY delivery (a.k.a. "Marketplace") means the order will be fulfilled by the vendor's fleet; PICKUP means that customers will go to the vendor and pick up the order. | OWN_DELIVERY, VENDOR_DELIVERY or PICKUP |
| is_preorder | `BOOLEAN` | Flag whether the order was preordered. | |
| order_status | `STRING` | Final status of the order. | completed or cancelled |
| [transitions](#transitions) | `ARRAY<RECORD>` | All order state transitions. Legacy (iCash) states are mapped to the new transmission service (OMA) | |
| received_at | `TIMESTAMP` | The timestamp when this row of record is generated within the RPS systems. | |
| waiting_for_transport_at | `TIMESTAMP` | When the order was sent to logistics systems. | |
| sending_to_vendor_at | `TIMESTAMP` | When the order was sent to vendor's device. | |
| received_by_vendor_at | `TIMESTAMP` | When the order was displayed on vendor's device. | |
| modified_by_vendor_at | `TIMESTAMP` | When the vendor removed items from the order. | |
| reconciliation_started_at | `TIMESTAMP` | When RPS acknowledged a reconciliation is needed due to changes to the original order. | |
| reconciled_with_platform_at | `TIMESTAMP` | When the order was successfully reconciled with Platform, RPS calls platform with changes and gets back changed order with updated products, pricing etc. | |
| reconciled_with_transport_at | `TIMESTAMP` | When the order was successfully reconciled with Logistics, Logistics have assigned transport to the modified order and it is ready to be picked up. | |
| minutes_to_accept | `INTEGER` | The time (in minutes) the vendor has to accept the order before it expires. | |
| accepted_by_vendor_at | `TIMESTAMP` | When the order was accepted by the vendor. | |
| implicitly_accepted_by_vendor_at | `TIMESTAMP` | For cases when vendor prepares the food without fulfilling some previous steps (e.g. order acceptance). It occurs whenever the courier notifying RPS about such a situation. | |
| prepared_at | `TIMESTAMP` | When the Vendor marks the food is ready to be picked up by the rider. OD Orders only. | |
| preparation_minutes | `INTEGER` | The estimated time (in minutes) it will take the restaurant to prepare the food from the moment it was sent to the vendor. | |
| estimated_pickup_at | `TIMESTAMP` | When to order is expected to be picked up. | |
| near_pickup_at | `TIMESTAMP` | When the currier was near the vendor, generated by logistics systems. For `OWN_DELIVERY` orders only. | |
| picked_up_at | `TIMESTAMP` | When the ordered was collected. For OWN_DELIVERY, it is generated by the logistics system (i.e. Hurrier). For VENDOR_DELIVERY, the vendor uses the dispatch button. | |
| near_dropoff_at | `TIMESTAMP` | When the courier was near the customer, generated by logistic systems. For OWN_DELIVERY orders only. | |
| promised_for | `TIMESTAMP` | First estimated delivery time given to the customer by Platform. | |
| estimated_deliver_at | `TIMESTAMP` | Most updated estimated delivery time given by Hurrier (OD) or by the Vendor (VD or PU). This information is sent to Platform so they can update the customer with a more accurate estimate. | |
| original_estimated_deliver_at | `TIMESTAMP` | In case the order has been delayed (once or multiple times) this contains the very first estimation given by Hurrier (OD) or by the Vendor (VD or PU). | |
| delivered_at | `TIMESTAMP` | When the order was successfully delivered by the courier, generated by logistics systems (i.e. Hurrier). For OWN_DELIVERY orders only. | |
| cancelled_at | `TIMESTAMP` | When the order failed. An order could fail at any stage throughout the lifecycle. | |
| stage | `STRING` | Up-to-date stage of the order status. | CONFIRMATION, PREPARATION or DELIVERY |
| [timings](#timings) | `RECORD` | The time difference in seconds between important transitions events. | |
| [cancellation](#cancellation) | `RECORD` | All cancellation related information from the order. Please refer to [GFR Standardization project](https://confluence.deliveryhero.com/display/RPS/Global+Fail+Reasons+%28GFR%29+Standardization) for more information | |
| [products](#products) | `ARRAY<RECORD>` | All products related information from the order **after** reconciliation, OMA orders only. | |
| [client](#client) | `RECORD` | All client related information of the order. | |
| [device](#device) | `RECORD` | All device related information. | |
| comment | `STRING` | The comment left by the customer in the order, this is passed by the platform. | |


## Entity
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| id | `STRING` | The code of the local operational entity representing the country. This code is made out of two codes : the two-letter code of the venture, and the country iso. | AP_PA, AR_HU, BK_DE, BK_SG, BO_CA, etc |
| display_name | `STRING` | The common name given to the entity. | |
| brand_id | `STRING` | The code of the global brand operating in the country, identical to the two-letter venture code. | AP, AR, BK, BO, CD, CG, DJ, etc |

## Vendor
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| id | `STRING` | The identifier of a physical vendor within RPS. | |
| code | `STRING` | The identifier of the vendor that is sent from the platform (e.g. Foodpanda) to the RPS systems. It is specific to the vendor within a platform. Only unique within the same region. To get a unique id of a record, concatenation of `entity.id` and `vendor.code` is suggested.| |

## Transitions
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| created_at | `TIMESTAMP` | When the change of the order state occurred. | |
| stage | `STRING` | Up-to-date stage of the order status. | CONFIRMATION, PREPARATION, DELIVERY or POST_DELIVERY |
| state | `STRING` | The state of the order, mapped to OMA for iCash orders. State machine found in Oma [Documentation](https://oma.stg.restaurant-partners.com/manual/index.html#rps_clients). | WAITING_FOR_TRANSPORT, ASSIGNED_TO_TRANSPORT, SENDING_TO_VENDOR, RECEIVED_BY_VENDOR, ACCEPTED_BY_VENDOR, NEAR_PICKUP, PICKED_UP, NEAR_DROPOFF, DELIVERED, CANCELLED, DELAYED or RECEIVED |
| source | `STRING` | Source defines where state change notification of a transition is coming from. | LOGISTICS, PLATFORM, RPS_CLIENT, RPS_CORE, RPS_CORE_LEGACY, SHOPPER or VENDOR_DEVICE |
| owner | `STRING` | Owner defines who was responsible for the change in the state of the order status. | VENDOR, CUSTOMER, TRANSPORT, FULFILMENT or PLATFORM |

## Timings
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| transmission_time | `INTEGER` | The time interval in seconds between `SENDING_TO_VENDOR` & `RECEIVED_BY_VENDOR` status. | |
| response_time | `INTEGER` | The time interval in seconds between `RECEIVED_BY_VENDOR` & `ACCEPTED_BY_VENDOR` status. | |
| preparation_time | `INTEGER` | The time interval in seconds between `ACCEPTED_BY_VENDOR` and `PICKUP` status. | |

## Cancellation
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| reason | `STRING` | The reason for the cancellation. Full list available in the [Global Fail Reasons List](https://product.deliveryhero.net/global-vendor/documentation/global-fail-reasons-list/). | BAD_WEATHER, BLACKLISTED_CUSTOMER, CARD_READER_NOT_AVAILABLE, CLOSED, CUSTOMER_DID_NOT_SHOW_UP, CUSTOMER_LEFT, CUSTOMER_NO_ANSWER, CUSTOMER_NO_SHOW, CUSTOMER_OUTSIDE_AREA, CUSTOMER_STILL_WAITING, DUPLICATE_ORDER, EXTRA_CHARGE_NEEDED, INCOMPLETE_ADDRESS, ITEM_UNAVAILABLE, MENU_ACCOUNT_PROBLEM, MODIFICATION_NOT_POSSIBLE, MOV_NOT_REACHED, NO_COURIER, OTHER, OUTSIDE_DELIVERY_AREA, PRODUCT_UNAVAILABLE, RESTAURANT_DELAY_CUSTOMER_LEFT, TECHNICAL_PROBLEM, TOO_BUSY, TOO_BUSY_KITCHEN, TOO_BUSY_NO_DRIVERS or UPDATES_IN_MENU |
| owner | `STRING` | Owner defines who was responsible for the order cancellation. | VENDOR, CUSTOMER, TRANSPORT, FULFILMENT or PLATFORM |
| is_cancelled_by_vendor | `BOOLEAN` | A flag indicating if cancellation owner equals to `VENDOR`. | |
| source | `STRING` | Source defines where the state change of a cancellation is coming from. | CONTACT_CENTER, CONTACT_CENTER_VENDOR, LOGISTICS, PLATFORM, RPS, SHOPPER or VENDOR_DEVICE |
| stage | `STRING` | Stage of the order status in which the order was cancelled. | CONFIRMATION, PREPARATION, DELIVERY or POST_DELIVERY |

## Products
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| id | `STRING` | The identifier of the product, generated from the Platform. |  |
| name | `STRING` | The name of the product, generated from the Platform. | |
| quantity | `INTEGER` | The quantity of the product. |  |

## Client
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| name | `STRING` | The RPS client being used by the vendor. | GOWIN, GODROID, POS or PLATFORM_CLIENT |
| version | `STRING` | The version of RPS client being used by the vendor. | |
| wrapper_type | `STRING` | The type of the wrapper being used by the client. GoWin orders exclusive. | ANDROID, IOS, WEB, WINDOWS or WINDOWS_XP |
| wrapper_version | `STRING` | The version of the wrapper being used by the client. GoWin orders exclusive. | |
| pos_integration_flow | `STRING` | In case is a POS client it shows whether it has a DIRECT or INDIRECT integration | DIRECT, INDIRECT or NULL |
| pos_integration_name | `STRING` | In case is a POS client it shows the name of its integration | |
| method | `STRING` | The method being used by the vendor. | PLATFORM_CLIENT, APPLICATION_CLIENT or POS |
| os_name | `STRING` | The operating system of the device used by the vendor. | Android, BlackBerry, Chrome OS, iOS, Linux, Macintosh, Windows, etc |
| os_version | `STRING` | The operating system version of the device used by the vendor. | |

## device
| Column | Type | Description | Categories |
| :--- | :--- | :--- | :--- |
| id | `STRING` | The universal unique identifier for the device within RPS. It is generated by the RPS Clients (GoDroid & GoWin) and stored in DMS. With region altogether, it can be used as joining key with the other CL tables. | |
| serial_number | `STRING` | The serial number of the device used by the vendor. | |
| mdm_service | `STRING` | The Mobile Devices Management solution applied to the device. | SOTI or MOBILOCK |
| manufacturer | `STRING` | The most popular manufacturers parsed from the model. | |
| model | `STRING` | The information about the device, e.g. the manufacturer and model type. | |
