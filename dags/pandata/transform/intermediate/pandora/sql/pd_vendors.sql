SELECT
  `{project_id}`.pandata_intermediate.PD_UUID(id, rdbms_id) AS uuid,
  id,
  rdbms_id,
  `{project_id}`.pandata_intermediate.PD_UUID(area_id, rdbms_id) AS area_uuid,
  area_id,
  `{project_id}`.pandata_intermediate.PD_UUID(calculation_configuration_template_id, rdbms_id) AS calculation_configuration_template_uuid,
  calculation_configuration_template_id,
  `{project_id}`.pandata_intermediate.PD_UUID(chain_id, rdbms_id) AS chain_uuid,
  chain_id,
  `{project_id}`.pandata_intermediate.PD_UUID(chain_menu_group_id, rdbms_id) AS chain_menu_group_uuid,
  chain_menu_group_id,
  `{project_id}`.pandata_intermediate.PD_UUID(city_id, rdbms_id) AS city_uuid,
  city_id,
  `{project_id}`.pandata_intermediate.PD_UUID(deliveryprovider_id, rdbms_id) AS delivery_provider_uuid,
  deliveryprovider_id AS delivery_provider_id,
  `{project_id}`.pandata_intermediate.PD_UUID(language_id, rdbms_id) AS language_uuid,
  language_id,
  `{project_id}`.pandata_intermediate.PD_UUID(option_value_vat_id, rdbms_id) AS option_value_vat_uuid,
  option_value_vat_id,
  `{project_id}`.pandata_intermediate.PD_UUID(primary_cuisine_id, rdbms_id) AS primary_cuisine_uuid,
  primary_cuisine_id,
  `{project_id}`.pandata_intermediate.PD_UUID(tag_id, rdbms_id) AS tag_uuid,
  tag_id,
  `{project_id}`.pandata_intermediate.PD_UUID(terms_id, rdbms_id) AS terms_uuid,
  terms_id,
  `{project_id}`.pandata_intermediate.PD_UUID(created_by, rdbms_id) AS created_by_user_uuid,
  created_by AS created_by_user_id,
  `{project_id}`.pandata_intermediate.PD_UUID(updated_by, rdbms_id) AS updated_by_user_uuid,
  updated_by AS updated_by_user_id,

  code,
  (
    IFNULL(address_line1, "") || IF(address_line2 IS NULL, "", '\n') ||
    IFNULL(address_line2, "")
  ) AS address,
  address_other,
  automatic_calls_phone AS automatic_calls_phone_number,
  customer_phone AS customer_phone_number,
  branch,
  budget,
  description,
  filepath,
  foodpanda_phone,
  internal_comment,
  lat AS latitude,
  lon AS longitude,
  menu_style,
  order_email,
  order_fax,
  order_pos,
  order_sms AS order_sms_number,
  postcode,
  prefered_contact,
  rating,
  title,
  website,
  zoom,

  customers_type,
  order_flow AS order_flow_type,
  pre_order_notification_type,
  rider_status_flow AS rider_status_flow_type,

  -- time
  automatic_calls_delay AS automatic_calls_delay_in_minutes,
  minimum_delivery_time AS minimum_delivery_time_in_minutes,
  pickup_time AS pickup_time_in_minutes,
  pre_order_notification_time AS pre_order_notification_time_in_minutes,

  -- booleans
  CAST(accept_customer_invitations AS BOOLEAN) AS is_customer_invitations_accepted,
  CAST(accept_delivery AS BOOLEAN) AS is_delivery_accepted,
  CAST(accept_discount AS BOOLEAN) AS is_discount_accepted,
  CAST(accept_pickup AS BOOLEAN) AS is_pickup_accepted,
  CAST(accept_voucher AS BOOLEAN) AS is_voucher_accepted,
  CAST(commission_payment AS BOOLEAN) AS is_commission_payment_enabled,
  CAST(accepts_special_instructions AS BOOLEAN) AS is_special_instructions_accepted,
  CAST(active AS BOOLEAN) AS is_active,
  CAST(deleted AS BOOLEAN) AS is_deleted,
  CAST(crosslisted AS BOOLEAN) AS is_crosslisted,
  CAST(automatic_calls_enabled AS BOOLEAN) AS is_automatic_calls_enabled,
  IFNULL(allow_preorder = 1, FALSE) AS is_preorder_allowed,
  customers_type = 'all' AS is_customers_type_all,
  customers_type = 'regular' AS is_customers_type_regular,
  customers_type = 'corporate' AS is_customers_type_corporate,
  order_flow = 'food' AS is_order_flow_food,
  order_flow = 'grocery' AS is_order_flow_grocery,
  CAST(disabled_mobile_app AS BOOLEAN) AS is_mobile_app_disabled,
  CAST(display_frontpage AS BOOLEAN) AS is_frontpage_displayed,
  CAST(display_only AS BOOLEAN) AS is_display_only,
  CAST(enable_split_payment AS BOOLEAN) AS is_split_payment_enabled,
  CAST(inherit_menu AS BOOLEAN) AS is_menu_inherited,
  CAST(inherit_schedule AS BOOLEAN) AS is_schedule_inherited,
  CAST(is_checkout_comment_enabled AS BOOLEAN) AS is_checkout_comment_enabled,
  CAST(is_disable_closing_after_declined_order AS BOOLEAN) AS is_closing_after_declined_order_disabled,
  CAST(is_new AS BOOLEAN) AS is_new,
  CAST(is_private AS BOOLEAN) AS is_private,
  CAST(testing AS BOOLEAN) AS is_test,
  CAST(is_replacement_dish_enabled AS BOOLEAN) AS is_replacement_dish_enabled,
  CAST(offline_calls_disabled AS BOOLEAN) AS is_offline_calls_disabled,
  CAST(offline_calls_status_closed AS BOOLEAN) AS is_offline_calls_status_closed,
  CAST(popular_products_enabled AS BOOLEAN) AS is_popular_products_enabled,
  CAST(multi_branch AS BOOLEAN) AS is_multi_branch,
  CAST(send_invoice AS BOOLEAN) AS is_invoice_sent,
  CAST(require_address_verification AS BOOLEAN) AS is_address_verification_required,
  CAST(rider_pickup_preassignment_enabled AS BOOLEAN) AS is_rider_pickup_preassignment_enabled,
  CAST(premium_listing AS BOOLEAN) AS is_premium_listing,
  CAST(vendor_sets_pickup_time AS BOOLEAN) AS is_pickup_time_set_by_vendor,
  CAST(vat_included AS BOOLEAN) AS is_vat_included,
  IFNULL(vat_visible = 1, FALSE) AS is_vat_visible,
  CAST(free_delivery AS BOOLEAN) AS has_free_delivery,
  IFNULL(delivery_charge = 1, FALSE) AS has_delivery_charge,
  IFNULL(service_charge = 1, FALSE) AS has_service_charge,
  CAST(temporary_adjustment_fees AS BOOLEAN) AS has_temporary_adjustment_fees,
  CAST(weekly_adjustment_fees AS BOOLEAN) AS has_weekly_adjustment_fees,

  -- currency
  basket_adjustment_fees AS basket_adjustment_fees_local,
  container_price AS container_price_local,
  IF(
    commission_type = 'percentage',
    commission / 100,
    commission
  ) AS commission_local,
  IF(
    commission_type = 'percentage',
    pickup_commission / 100,
    pickup_commission
  ) AS pickup_commission_local,
  maximum_delivery_fee AS maximum_delivery_fee_local,
  maximum_express_order_amount AS maximum_express_order_amount_local,
  minimum_delivery_fee AS minimum_delivery_fee_local,
  minimum_delivery_value AS minimum_delivery_value_local,
  service_fee AS service_fee_local,

  -- timestamps
  is_new_until AS new_until_local,
  terms_validity AS terms_valid_until_date,
  created_at AS created_at_local,
  updated_at AS updated_at_local,
  dwh_last_modified AS dwh_last_modified_at_utc
FROM `{project_id}.pandata_raw_ml_backend_latest.vendors`
